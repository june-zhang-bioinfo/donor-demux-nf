# Extract username/repo@sha
cat(gsub("GitHub: ", "", g), "\n")
}
}
if (length(bioc) > 0) {
for (b in bioc) {
cat("bioc::", b, "\n", sep = "")
}
}
}
invisible(deps)
}
packageDescription("convert2anndata")
packageDescription("ComplexHeatmap")
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
# comment = c(ORCID = "YOUR-ORCID-ID")  # Optional
),
Language = "en",  # Change from "es" to "en" unless you want Spanish!
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
# a new Rstudio pops up
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
# comment = c(ORCID = "YOUR-ORCID-ID")  # Optional
),
Language = "en",  # Change from "es" to "en" unless you want Spanish!
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
# a new Rstudio pops up
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
),
Language = "en",
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
packageVersion("harmony")
packageVersion("yaml")
packageVersion("sessioninfo")
packageVersion("matrixStats")
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
),
Language = "en",
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
# a new Rstudio pops up
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
),
Language = "en",
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
# a new Rstudio pops up
file.copy("/Users/zz005/Documents/github/BioYourOwnBowl-demo.Rmd", "vignettes/BioYourOwnBowl-demo.Rmd", overwrite = TRUE)
getwd()
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
),
Language = "en",
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
# a new Rstudio pops up
package_version("ggbreak")
packageVersion("ggbreak")
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
),
Language = "en",
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
# a new Rstudio pops up
packageVersion("harmony")
packageVersion("ggtext")
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
),
Language = "en",
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
# a new Rstudio pops up
packageVersion("knitr")
packageVersion("rmarkdown")
BiocManager::install(version = "3.20", ask = TRUE)
packageVersion("BiocManager")
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
),
Language = "en",
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
# a new Rstudio pops up
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
),
Language = "en",
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
# a new Rstudio pops up
?rowSums
packageVersion("Matrix")
# Load 10X data
# data_dir_base <- system.file("extdata", package = "BioYourOwnBowl")
data_path <- file.path("example_data/sample_filtered_feature_bc_matrix")
object <- Read10X(data.dir = data_path)
library(BioYourOwnBowl)
library(Seurat)
library(dplyr)
library(stringr)
# Load 10X data
# data_dir_base <- system.file("extdata", package = "BioYourOwnBowl")
data_path <- file.path("example_data/sample_filtered_feature_bc_matrix")
object <- Read10X(data.dir = data_path)
seurat_obj <- CreateSeuratObject(counts = object)
# Load cell type annotations
data_path <- file.path("example_data/cell_types/cell_types.csv")
cell_types <- read.csv(data_path)
# Add metadata
meta <- seurat_obj@meta.data
meta$cell_id <- rownames(meta)
meta <- left_join(meta, cell_types, by = c("cell_id" = "barcode"))
# Add artificial clinical metadata
set.seed(42)
n <- nrow(meta)
meta <- meta %>%
mutate(
Patient = sample(paste0("P", 1:4), n, replace = TRUE),
Cohort = sample(c("Acute", "Chronic"), n, replace = TRUE),
Timepoint = sample(c("Baseline", "Week2", "Post-Treatment"), n, replace = TRUE),
clusters = sample(1:8, n, replace = TRUE)
)
rownames(meta) <- meta$cell_id
seurat_obj@meta.data <- meta
# Calculate mitochondrial percentage
seurat_obj$percent.mt <- PercentageFeatureSet(seurat_obj, pattern = "^MT-")
# Clean gene names
rownames(seurat_obj) <- gsub("-", ".", rownames(seurat_obj))
seurat_obj
seurat_obj@assays[['RNA']]$counts
mt <- seurat_obj@assays[['RNA']]$counts
dim(mt)
assay <- "RNA"
object <- seurat_obj
gene_expression_matrix <- object@assays[[assay]]$counts
gene_expression_count <- rowSums(gene_expression_matrix > 0)
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
),
Language = "en",
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
# a new Rstudio pops up
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
),
Language = "en",
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
# a new Rstudio pops up
?Seurat::Stdev
?Stdev
?RotatedAxis
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
),
Language = "en",
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
# a new Rstudio pops up
packageVersion("ggpubr")
?eulerr::plot.euler
?near
?rlang::.data
?median
?theme
?element_text
?desc
?FeaturePlot_scCustom
?scCustomize::FeaturePlot_scCustom()
?
near
?across
?everything
?head
?Seurat::`Idents<-`()
?Seurat::`Idents<-`
?left_join
?select
?HeatmapAnnotation
?Heatmap
?grid.newpage
?distinct
?is_empty
?sym
?rainbow
?gpar
?rownames_to_column
?all_of
?mean
?median
?str_sort
options(
usethis.full_name = "June Zhang",
usethis.description = list(
"Authors@R" = utils::person(
"June", "Zhang",
email = "zhang24925@gmail.com",
role = c("aut", "cre")
),
Language = "en",
License = "MIT + file LICENSE",
Title = "Custom Seurat Utilities for Single-Cell Analysis",
Description = "Provides custom utility functions for Seurat single-cell RNA sequencing data analysis.",
Imports = "Seurat, ggplot2, Matrix"
)
)
usethis::create_package("BioYourOwnBowl")
getwd()
1259*1.08
1259*1.08*52
3440 * 9
80+120+20
library(Seurat)
getwd()
setwd("/Users/zz005/Documents/github/docker/my_docker_3.0/data/")
library(Matrix)
data_dir <- "/Users/zz005/Documents/github/docker/my_docker_3.0/data/"
expression_matrix <- Read10X(data.dir = data_dir)
dim(expression_matrix)
expression_matrix <- Read10X(data.dir = data_dir)
# 3. Create a Seurat Object
# We filter slightly here to ensure the object is valid (at least 3 cells per gene)
seurat_obj <- CreateSeuratObject(
counts = expression_matrix,
project = "test_run"
)
# 4. Save the object as an RDS file
output_file <- paste0(data_dir, "matrix.rds")
print(paste("Saving RDS to:", output_file))
saveRDS(seurat_obj, file = output_file)
print("Done!")
getwd()
library(Seurat)
library(Matrix)
obj <- readRDS("matrix.rds")
dim(obj)
obj
colnames(obj)
df <- read.csv("/Users/zz005/Downloads/test_run_posteriors.csv")
View(df)
df$BARCODE %in% colnames(obj)
table(df$BARCODE %in% colnames(obj))
demuxalot <- df
demuxalot
obj
meta <- obj@meta.data
meta$cell_id <- rownames(meta)
rownames(meta)
# --- 3. Demuxalot Assignment ---
demuxalot$assignment <- NA
# Find the column index with the max value for each row (excluding BARCODE)
max_indices <- apply(demuxalot[, 2:ncol(demuxalot)], 1, which.max)
# Map the index back to the column name (1 + index for 1-based indexing)
demuxalot$assignment <- colnames(demuxalot)[1 + max_indices]
demuxalot$assignment <- sub("X","",demuxalot$assignment)
demuxalot$assignment <- gsub(".","-",demuxalot$assignment, fixed = T)
cat("Assignment Table:\n")
print(table(demuxalot$assignment))
# --- 4. Merge Demultiplexing ---
demuxalot_1 <- subset(demuxalot, select = c("BARCODE", "assignment"))
order <- rownames(meta)
meta <- merge(meta, demuxalot_1, by.x = "cell_id", by.y = "BARCODE", all.x = TRUE)
meta <- meta %>% slice(match(order, cell_id))
rownames(meta) <- meta$cell_id
obj@meta.data <- meta
library(dplyr)
View(demuxalot_1)
View(demuxalot)
?left_join
# order <- rownames(meta)
# meta <- merge(meta, demuxalot_1, by.x = "cell_id", by.y = "BARCODE", all.x = TRUE)
# meta <- meta %>% slice(match(order, cell_id))
meta <- left_join(meta, demuxalot_1, by = c("cell_id" = "BARCODE"))
View(meta)
meta <- obj@meta.data
meta$cell_id <- rownames(meta)
# --- 3. Demuxalot Assignment ---
demuxalot$assignment <- NA
# Find the column index with the max value for each row (excluding BARCODE)
max_indices <- apply(demuxalot[, 2:ncol(demuxalot)], 1, which.max)
# Map the index back to the column name (1 + index for 1-based indexing)
demuxalot$assignment <- colnames(demuxalot)[1 + max_indices]
demuxalot$assignment <- sub("X","",demuxalot$assignment)
demuxalot$assignment <- gsub(".","-",demuxalot$assignment, fixed = T)
cat("Assignment Table:\n")
print(table(demuxalot$assignment))
# --- 4. Merge Demultiplexing ---
demuxalot_1 <- subset(demuxalot, select = c("BARCODE", "assignment"))
View(meta)
meta <- obj@meta.data
View(meta)
rownames(demuxalot)
# --- 5. PCA ---
rownames(demuxalot) <- demuxalot$BARCODE
rownames(demuxalot)
clusters_pca <- subset(demuxalot, select = -c(BARCODE, assignment))
clusters_pca <- log2(abs(clusters_pca) + 1)
clusters_pca <- prcomp(clusters_pca, scale = TRUE, center = TRUE)
PCi <- data.frame(clusters_pca$x)
PCi$cell_id <- rownames(PCi)
PCi <- merge(PCi, meta, by = "cell_id", all.x = TRUE)
PCi <- merge(PCi, sex, by.x = "assignment", by.y = "patient", all.x = TRUE)
ggplot(PCi, aes(x = PC1, y = PC2, col = sex)) +
geom_point(size = 1, alpha = 0.7) +
theme_classic() +
scale_color_manual(values = c("#F8A19FFF", "#325A9BFF", "#27e627d4")) +
ggtitle(experiment1)
library(ggplot2)
ggplot(PCi, aes(x = PC1, y = PC2, col = sex)) +
geom_point(size = 1, alpha = 0.7) +
theme_classic() +
scale_color_manual(values = c("#F8A19FFF", "#325A9BFF", "#27e627d4")) +
ggtitle(experiment1)
ggplot(PCi, aes(x = PC1, y = PC2, col = sex)) +
geom_point(size = 1, alpha = 0.7) +
theme_classic() +
scale_color_manual(values = c("#F8A19FFF", "#325A9BFF", "#27e627d4")) +
ggtitle("")
ggplot(PCi, aes(x = PC1, y = PC2)) +
geom_point(size = 1, alpha = 0.7) +
theme_classic() +
scale_color_manual(values = c("#F8A19FFF", "#325A9BFF", "#27e627d4")) +
ggtitle("")
PCi
ggplot(PCi, aes(x = PC1, y = PC3)) +
geom_point(size = 1, alpha = 0.7) +
theme_classic() +
scale_color_manual(values = c("#F8A19FFF", "#325A9BFF", "#27e627d4")) +
ggtitle("")
ggplot(PCi, aes(x = PC2, y = PC3)) +
geom_point(size = 1, alpha = 0.7) +
theme_classic() +
scale_color_manual(values = c("#F8A19FFF", "#325A9BFF", "#27e627d4")) +
ggtitle("")
p1 <- ggplot(PCi, aes(x = PC2, y = PC3)) +
geom_point(size = 1, alpha = 0.7) +
theme_classic() +
scale_color_manual(values = c("#F8A19FFF", "#325A9BFF", "#27e627d4")) +
ggtitle("")
p2 <- ggplot(PCi, aes(x = PC2, y = PC3)) +
geom_point(size = 1, alpha = 0.7) +
theme_classic() +
scale_color_manual(values = c("#F8A19FFF", "#325A9BFF", "#27e627d4")) +
ggtitle("")
p3 <- ggplot(PCi, aes(x = PC2, y = PC3)) +
geom_point(size = 1, alpha = 0.7) +
theme_classic() +
scale_color_manual(values = c("#F8A19FFF", "#325A9BFF", "#27e627d4")) +
ggtitle("")
p4 <- ggplot(PCi, aes(x = PC2, y = PC3)) +
geom_point(size = 1, alpha = 0.7) +
theme_classic() +
scale_color_manual(values = c("#F8A19FFF", "#325A9BFF", "#27e627d4")) +
ggtitle("")
p5 <- ggplot(PCi, aes(x = PC2, y = PC3)) +
geom_point(size = 1, alpha = 0.7) +
theme_classic() +
scale_color_manual(values = c("#F8A19FFF", "#325A9BFF", "#27e627d4")) +
ggtitle("")
p6 <- ggplot(PCi, aes(x = PC2, y = PC3)) +
geom_point(size = 1, alpha = 0.7) +
theme_classic() +
scale_color_manual(values = c("#F8A19FFF", "#325A9BFF", "#27e627d4")) +
ggtitle("")
pdf(file = paste0("PCA_plots.pdf"), width = 10, height = 5)
print(plot_grid(p1, p2, p3, p4, p5, p6,nrow = 2))
library(grid)
print(plot_grid(p1, p2, p3, p4, p5, p6,nrow = 2))
library(cowplot)
print(plot_grid(p1, p2, p3, p4, p5, p6,nrow = 2))
dev.off()
getwd()
